From 61416ff1bc2843ac21d65f0a29f3d38eae614859 Mon Sep 17 00:00:00 2001
From: Tay Ray Chuan <rctay89@gmail.com>
Date: Wed, 28 Aug 2013 12:09:54 +0800
Subject: [PATCH 05/21] use common rules

 - LF, SP are all defined in RFC 5234 - don't define them again.
 - use HTAB instead of HT - HTAB is another common rule.
 - use obj-id, zero-id, refname - they are defined in protocol-common.txt.
---
 Documentation/technical/http-protocol.txt | 36 +++++++++++--------------------
 1 file changed, 12 insertions(+), 24 deletions(-)

diff --git a/Documentation/technical/http-protocol.txt b/Documentation/technical/http-protocol.txt
index 22d215e..47b61df 100644
--- a/Documentation/technical/http-protocol.txt
+++ b/Documentation/technical/http-protocol.txt
@@ -194,14 +194,9 @@ the default ref named 'HEAD'.
   info_refs        =  *( ref_record )
   ref_record       =  any_ref | peeled_ref
 
-  any_ref          =  id HT name LF
-  peeled_ref       =  id HT name LF
-		      id HT name "^{}" LF
-  id               =  40*HEX
-
-  HEX              =  "0".."9" | "a".."f"
-  LF               =  <US-ASCII LF, linefeed (10)>
-  HT               =  <US-ASCII HT, horizontal-tab (9)>
+  any_ref          =  obj-id HTAB refname LF
+  peeled_ref       =  obj-id HTAB refname LF
+		      obj-id HTAB refname "^{}" LF
 
 Smart Clients
 ~~~~~~~~~~~~~
@@ -290,24 +285,17 @@ declarations behind a NUL on the first ref.
 		      "0000"
   ref_list         =  empty_list | populated_list
 
-  empty_list       =  PKT-LINE(id SP "capabilities^{}" NUL cap_list LF)
+  empty_list       =  PKT-LINE(obj-id SP "capabilities^{}" NUL cap_list LF)
 
-  non_empty_list   =  PKT-LINE(id SP name NUL cap_list LF)
+  non_empty_list   =  PKT-LINE(obj-id SP name NUL cap_list LF)
 		      *ref_record
 
   cap_list         =  *(SP capability) SP
   ref_record       =  any_ref | peeled_ref
 
-  any_ref          =  PKT-LINE(id SP name LF)
-  peeled_ref       =  PKT-LINE(id SP name LF)
-		      PKT-LINE(id SP name "^{}" LF
-  id               =  40*HEX
-
-  HEX              =  "0".."9" | "a".."f"
-  NL               =  <US-ASCII NUL, null (0)>
-  LF               =  <US-ASCII LF,  linefeed (10)>
-  SP               =  <US-ASCII SP,  horizontal-tab (9)>
-
+  any_ref          =  PKT-LINE(obj-id SP name LF)
+  peeled_ref       =  PKT-LINE(obj-id SP name LF)
+		      PKT-LINE(obj-id SP name "^{}" LF
 
 Smart Service git-upload-pack
 ------------------------------
@@ -354,8 +342,8 @@ appear in the response obtained through ref discovery.
   have_list        =  *PKT-LINE("have" SP id LF)
 
   command          =  create | delete | update
-  create           =  40*"0" SP new_id SP name
-  delete           =  old_id SP 40*"0" SP name
+  create           =  zero-id SP new_id SP name
+  delete           =  old_id SP zero-id SP name
   update           =  old_id SP new_id SP name
 
 TODO: Document this further.
@@ -531,8 +519,8 @@ the id obtained through ref discovery as old_id.
   cap_list         =  *(SP capability) SP
 
   command          =  create | delete | update
-  create           =  40*"0" SP new_id SP name
-  delete           =  old_id SP 40*"0" SP name
+  create           =  zero-id SP new_id SP name
+  delete           =  old_id SP zero-id SP name
   update           =  old_id SP new_id SP name
 
 TODO: Document this further.
-- 
1.8.4.rc4.527.g303b16c

